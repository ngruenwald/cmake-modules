include(external.cmake)

set(EXT_VERSION "1.2.12")
set(EXT_URL_HASH "SHA256=7c9917b80c125e317e44c9d83a4c15390dac9967df27397024beaf4342e0f8cd")

ExternalProject_Add(
  ext_zlib
  UPDATE_DISCONNECTED true
  URL https://github.com/madler/zlib/archive/refs/tags/v${EXT_VERSION}.zip
  URL_HASH ${EXT_URL_HASH}
  CMAKE_ARGS
    -D CMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}
    -D CMAKE_INSTALL_PREFIX=${EXTERNAL_INSTALL_LOCATION}
    -D HTTPLIB_COMPILE=ON
    -D HTTPLIB_REQUIRE_OPENSSL=ON
    -D OPENSSL_USE_STATIC_LIBS=ON
    -D OPENSSL_ROOT_DIR=${OPENSSL_ROOT_DIR}
    -D BUILD_SHARED_LIBS=OFF
)

add_dependencies(contrib ext_zlib)
